# JsoupAndPOI
###### 因舊的沒備份到，因此新做一個爬蟲，也是回溫複習
### - 動機 
---
###### (在此 A 品牌購物簡稱A，B品牌購物簡稱B)
 當時有個 A 網站要併到B網站裡，用人工處理會不符合效益，~~(好啦~其實剛好有機會我是想練練程式 誤)~~<br>
 是因為有3點困難點<br>
1. A 網站租約快到期，老闆不想繼續使用 ~~(此事引爆點)~~ <br>
2. 當時出貨量爆多，無法擠出一人專門處理<br>
3. 該網站商品總數有800多個 <br>

　因此我向主管提出給我1個月時間，用下班時間跟假日寫程式來處理 A 網站的資料，若無成果的話，只好擠出一人來處理，而主管同意讓我試試我的提議。<br>
　結果我花3個禮拜完成 Java 爬蟲，很有成就的解決此事。
 
---
### - 開發過程 : <br>
我先分成兩部分依序進行<br>
```
1.先用 Jsoup 爬取資料
　- 遇到 Jsoup 訪問網址失敗，是 Jsoup 版本關係，遇到目標網址有HTTPS協議，訪問者未指定證書，才導致拋出異常。使用 validateTLSCertificates(false)，忽略證書驗證，但並非最好辦法。
　- 因每個商品都有商品描述跟圖片連結兩個字串，思考回傳時有2種型態可選: 陣列、物件，我選擇前者。

2.接著 Excel 讀寫
　- 先前舊的 Library 不是使用 Apache POI，因此先花點時間研究
```
### - 瓶頸，這是在舊的程式沒遇到的問題
---
確認有從 Excel 讀取內容，但 Jsoup 訪問的網址卻一直不正確，發現 Excel 的商品名稱在 url 的商品名稱並非相同，才發現到它有規則。
1.有英文的都是小寫
2.因 url 在新增商品時，是記錄一開始設定的商品名稱。若日後更改商品名稱，url 不會變動，才導致無法訪問到正確網址，因此我用正則表達式處理這問題，也讓我對正則表達式更有點熟練。
